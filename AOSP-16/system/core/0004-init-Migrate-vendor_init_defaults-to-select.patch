From 982771b514a881f1bb979ea8abd76938e5d6345e Mon Sep 17 00:00:00 2001
From: Michael Bestas <mkbestas@lineageos.org>
Date: Fri, 25 Apr 2025 00:00:14 +0300
Subject: [PATCH 04/20] init: Migrate vendor_init_defaults to select()

Change-Id: I485511ba41b96a9b95f83e8ae35cabf89d4cdb35
---
 init/Android.bp | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/init/Android.bp b/init/Android.bp
index b9d1f91b94..4907dddc31 100644
--- a/init/Android.bp
+++ b/init/Android.bp
@@ -223,7 +223,6 @@ cc_defaults {
     defaults: [
         "init_defaults",
         "selinux_policy_version",
-        "vendor_init_defaults",
     ],
     srcs: init_common_sources + init_device_sources,
     export_include_dirs: ["."],
@@ -232,7 +231,10 @@ cc_defaults {
     ],
     whole_static_libs: [
         "libcap",
-    ],
+    ] + select(soong_config_variable("libinit", "vendor_init_lib"), {
+        any @ flag_val: [flag_val],
+        default: ["vendor_init"],
+    }),
     header_libs: ["bootimg_headers"],
     proto: {
         type: "lite",
-- 
2.39.5

