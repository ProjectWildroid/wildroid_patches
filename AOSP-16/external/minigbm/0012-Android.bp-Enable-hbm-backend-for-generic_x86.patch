From 9f92288bf16ba4945841fd73eb9397b4dfe6bb57 Mon Sep 17 00:00:00 2001
From: Yumi Yukimura <me.cafebabe@gmail.com>
Date: Sat, 26 Jul 2025 19:21:03 +0800
Subject: [PATCH 12/12] Android.bp: Enable hbm backend for generic_x86

Change-Id: I288f250572808439e9df6df5b35ce8d50d073e94
---
 Android.bp | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/Android.bp b/Android.bp
index cd0ee56..8331938 100644
--- a/Android.bp
+++ b/Android.bp
@@ -43,6 +43,7 @@ filegroup {
         "drv_array_helpers.c",
         "drv_helpers.c",
         "dumb_driver.c",
+        "hbm.c",
         "i915.c",
         "mediatek.c",
         "msm.c",
@@ -139,6 +140,11 @@ cc_defaults {
 
     defaults: ["minigbm_defaults"],
 
+    cflags: select(soong_config_variable("minigbm", "platform"), {
+        "generic_x86": ["-DDRV_HBM_HELPER"],
+        default: [],
+    }),
+
     header_libs: [
         "libhardware_headers",
         "libnativebase_headers",
@@ -158,7 +164,10 @@ cc_defaults {
         "liblog",
         "libnativewindow",
         "libsync",
-    ],
+    ] + select(soong_config_variable("minigbm", "platform"), {
+        "generic_x86": ["libhbm_minigbm"],
+        default: [],
+    }),
 }
 
 cc_defaults {
-- 
2.39.5

