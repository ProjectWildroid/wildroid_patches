From fc53852af0c3bab0a963b52ea033368358dd3df4 Mon Sep 17 00:00:00 2001
From: Yumi Yukimura <me.cafebabe@gmail.com>
Date: Fri, 1 Aug 2025 18:44:35 +0800
Subject: [PATCH] WILDROID: Define IMAPPER_LIBRARY_SUFFIX instead

Change-Id:
---
 hals/gralloc/minigbm/cros_gralloc/aidl/Android.bp | 13 ++++---------
 1 file changed, 4 insertions(+), 9 deletions(-)

diff --git a/hals/gralloc/minigbm/cros_gralloc/aidl/Android.bp b/hals/gralloc/minigbm/cros_gralloc/aidl/Android.bp
index 8e60a50..c4556a2 100644
--- a/hals/gralloc/minigbm/cros_gralloc/aidl/Android.bp
+++ b/hals/gralloc/minigbm/cros_gralloc/aidl/Android.bp
@@ -1,11 +1,3 @@
-gensrcs {
-    name: "gen_minigbm_cros_gralloc_aidl_Allocator_cpp_intel",
-    // Escape from out/soong/.temp/sbox/RANDOM to build root
-    cmd: "sed \"s|*outResult = \\\"minigbm\\\";|*outResult = \\\"minigbm_intel\\\";|g\" ../../../../../external/minigbm/cros_gralloc/aidl/Allocator.cpp > $(out)",
-    output_extension: "cpp",
-    srcs: ["Allocator.cpp"],
-}
-
 cc_binary {
     name: "android.hardware.graphics.allocator-service.minigbm_intel",
     defaults: ["minigbm_cros_gralloc_defaults"],
@@ -26,8 +18,11 @@ cc_binary {
     static_libs: [
         "libaidlcommonsupport",
     ],
+    cflags: [
+        "-DIMAPPER_LIBRARY_SUFFIX=\"minigbm_intel\"",
+    ],
     srcs: [
-        ":gen_minigbm_cros_gralloc_aidl_Allocator_cpp_intel",
+        "Allocator.cpp",
         "Main.cpp",
     ],
     enabled: false,
-- 
2.39.5

